SELECT  top(6) id_empresa,count(DESC_EMPRESA) as Conteo
FROM Ind_Disp_Red_Acceso group by DESC_EMPRESA,id_empresa order by Conteo desc;

select top(1) DESC_EMPRESA from Ind_Disp_Red_Acceso where ID_EMPRESA = 805006014;


select ANNO,count(anno) from Ind_Disp_Red_Acceso where ID_EMPRESA = 805006014 GROUP BY ANNO;

SELECT top(4) DESC_MUNICIPIO,id_MUNICIPIO,count(*) as Conteo
FROM Ind_Disp_Red_Acceso group by DESC_MUNICIPIO,id_MUNICIPIO order by Conteo desc;

SELECT  DESC_TECNOLOGIA,ID_TECNOLOGIA,count(DESC_TECNOLOGIA) as Conteo
FROM Ind_Disp_Red_Acceso group by DESC_tecnologia,ID_TECNOLOGIA order by Conteo desc;


WITH TBL AS (
    SELECT 
        ANNO, MES, ID_EMPRESA,DESC_EMPRESA, ID_TECNOLOGIA,
		CASE 
            WHEN ID_TECNOLOGIA = 1  THEN '2G'
            WHEN ID_TECNOLOGIA = 2  THEN '3G'
			WHEN ID_TECNOLOGIA = 3  THEN '4G'
            WHEN ID_TECNOLOGIA = 4  THEN 'CMTS'
			WHEN ID_TECNOLOGIA = 5  THEN 'OLT'
            ELSE '' 
        END AS DESC_TECNOLOGIA, 
		ID_MUNICIPIO,
		CASE 
            WHEN ID_MUNICIPIO = 11001 THEN 'Bogota'
            WHEN ID_MUNICIPIO = 76001 THEN 'Cali'
			WHEN ID_MUNICIPIO = 5001  THEN 'Medellin'
            WHEN ID_MUNICIPIO = 8001  THEN 'Barranquilla'
            ELSE '' 
        END AS DESC_CIUDAD,
		TIEMPO_TOTAL_INDISPONIBILIDAD,PORCENTAJE_DE_DISPONIBILIDAD 
    FROM Ind_Disp_Red_Acceso 
    WHERE
        (id_empresa IN (800153993, 830114921, 830122566, 901354361, 830016046, 805006014)) AND
        (id_MUNICIPIO IN (11001, 5001, 76001, 8001))
)
SELECT * FROM TBL
ORDER BY ANNO DESC, MES DESC;



WITH TBL AS (
    SELECT 
        ANNO, MES, ID_EMPRESA, ID_TECNOLOGIA,
		ID_MUNICIPIO,TIEMPO_TOTAL_INDISPONIBILIDAD,PORCENTAJE_DE_DISPONIBILIDAD 
    FROM Ind_Disp_Red_Acceso 
    WHERE
        (id_empresa IN (800153993, 830114921, 830122566, 901354361, 830016046, 805006014)) AND
        (id_MUNICIPIO IN (11001, 5001, 76001, 8001))
)
SELECT * FROM TBL
ORDER BY ANNO DESC, MES DESC,TIEMPO_TOTAL_INDISPONIBILIDAD;



WITH TBL AS (
    SELECT 
       *
    FROM Ind_Disp_Red_Acceso 
    WHERE
        (id_empresa IN (800153993, 830114921, 830122566, 901354361, 830016046, 805006014)) AND
        (id_MUNICIPIO IN (11001, 5001, 76001, 8001))
)
SELECT * FROM TBL
ORDER BY ANNO DESC, MES DESC,TIEMPO_TOTAL_INDISPONIBILIDAD;




